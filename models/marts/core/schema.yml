version: 2

models:

  - name: dim_airports
    description: "Dimension table containing all airports, with their name, city, country, and geographical coordinates."
    columns:
      - name: airport_id
        tests:
          - unique
          - not_null
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: integer
      - name: latitude
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: -90
              max_value: 90
      - name: longitude
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: -180
              max_value: 180    

  - name: dim_airlines
    description: "Dimension table containing all airlines, with their name and country of origin."
    columns:
      - name: airline_id
        tests:
          - unique
          - not_null
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: integer

  - name: fct_routes
    description: "Fact table containing all flight routes, with source and destination airports, and whether the route is direct or not."
    columns:

      - name: source_airport_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_airports')
              field: airport_id

      - name: destination_airport_id
        tests:
          - relationships:
              to: ref('dim_airports')
              field: airport_id

      - name: is_direct
        tests:
          - accepted_values:
              values: [true, false]